import{_ as l,I as s,c as h,o as n,a3 as p,J as a}from"./chunks/framework.Coydrlbh.js";const u=JSON.parse('{"title":"聊天API","description":"","frontmatter":{},"headers":[],"relativePath":"docs/development/plugins/api/chat-api.md","filePath":"docs/development/plugins/api/chat-api.md","lastUpdated":1756555974000}'),r={name:"docs/development/plugins/api/chat-api.md"};function k(d,i,o,g,c,y){const t=s("NolebaseGitContributors"),e=s("NolebaseGitChangelog");return n(),h("div",null,[i[0]||(i[0]=p(`<h1 id="聊天api" tabindex="-1">聊天API <a class="header-anchor" href="#聊天api" aria-label="Permalink to “聊天API”">​</a></h1><p>聊天API模块专门负责聊天信息的查询和管理，帮助插件获取和管理不同的聊天流。</p><h2 id="导入方式" tabindex="-1">导入方式 <a class="header-anchor" href="#导入方式" aria-label="Permalink to “导入方式”">​</a></h2><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> src.plugin_system </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> chat_api</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 或者</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> src.plugin_system.apis </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> chat_api</span></span></code></pre></div><p>一种<strong>Deprecated</strong>方式：</p><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> src.plugin_system.apis.chat_api </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ChatManager</span></span></code></pre></div><h2 id="主要功能" tabindex="-1">主要功能 <a class="header-anchor" href="#主要功能" aria-label="Permalink to “主要功能”">​</a></h2><h3 id="_1-获取所有的聊天流" tabindex="-1">1. 获取所有的聊天流 <a class="header-anchor" href="#_1-获取所有的聊天流" aria-label="Permalink to “1. 获取所有的聊天流”">​</a></h3><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> get_all_streams</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(platform: Optional[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> SpecialTypes </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;qq&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) -&gt; List[ChatStream]:</span></span></code></pre></div><p><strong>Args</strong>:</p><ul><li><code>platform</code>：平台筛选，默认为&quot;qq&quot;，可以使用<code>SpecialTypes</code>枚举类中的<code>SpecialTypes.ALL_PLATFORMS</code>来获取所有平台的聊天流。</li></ul><p><strong>Returns</strong>:</p><ul><li><code>List[ChatStream]</code>：聊天流列表</li></ul><h3 id="_2-获取群聊聊天流" tabindex="-1">2. 获取群聊聊天流 <a class="header-anchor" href="#_2-获取群聊聊天流" aria-label="Permalink to “2. 获取群聊聊天流”">​</a></h3><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> get_group_streams</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(platform: Optional[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> SpecialTypes </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;qq&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) -&gt; List[ChatStream]:</span></span></code></pre></div><p><strong>Args</strong>:</p><ul><li><code>platform</code>：平台筛选，默认为&quot;qq&quot;，可以使用<code>SpecialTypes</code>枚举类中的<code>SpecialTypes.ALL_PLATFORMS</code>来获取所有平台的群聊流。</li></ul><p><strong>Returns</strong>:</p><ul><li><code>List[ChatStream]</code>：群聊聊天流列表</li></ul><h3 id="_3-获取私聊聊天流" tabindex="-1">3. 获取私聊聊天流 <a class="header-anchor" href="#_3-获取私聊聊天流" aria-label="Permalink to “3. 获取私聊聊天流”">​</a></h3><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> get_private_streams</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(platform: Optional[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> SpecialTypes </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;qq&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) -&gt; List[ChatStream]:</span></span></code></pre></div><p><strong>Args</strong>:</p><ul><li><code>platform</code>：平台筛选，默认为&quot;qq&quot;，可以使用<code>SpecialTypes</code>枚举类中的<code>SpecialTypes.ALL_PLATFORMS</code>来获取所有平台的私聊流。</li></ul><p><strong>Returns</strong>:</p><ul><li><code>List[ChatStream]</code>：私聊聊天流列表</li></ul><h3 id="_4-根据群id获取聊天流" tabindex="-1">4. 根据群ID获取聊天流 <a class="header-anchor" href="#_4-根据群id获取聊天流" aria-label="Permalink to “4. 根据群ID获取聊天流”">​</a></h3><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> get_stream_by_group_id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(group_id: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, platform: Optional[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> SpecialTypes </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;qq&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) -&gt; Optional[ChatStream]:</span></span></code></pre></div><p><strong>Args</strong>:</p><ul><li><code>group_id</code>：群聊ID</li><li><code>platform</code>：平台筛选，默认为&quot;qq&quot;，可以使用<code>SpecialTypes</code>枚举类中的<code>SpecialTypes.ALL_PLATFORMS</code>来获取所有平台的群聊流。</li></ul><p><strong>Returns</strong>:</p><ul><li><code>Optional[ChatStream]</code>：聊天流对象，如果未找到返回None</li></ul><h3 id="_5-根据用户id获取私聊流" tabindex="-1">5. 根据用户ID获取私聊流 <a class="header-anchor" href="#_5-根据用户id获取私聊流" aria-label="Permalink to “5. 根据用户ID获取私聊流”">​</a></h3><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> get_stream_by_user_id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(user_id: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, platform: Optional[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> SpecialTypes </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;qq&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) -&gt; Optional[ChatStream]:</span></span></code></pre></div><p><strong>Args</strong>:</p><ul><li><code>user_id</code>：用户ID</li><li><code>platform</code>：平台筛选，默认为&quot;qq&quot;，可以使用<code>SpecialTypes</code>枚举类中的<code>SpecialTypes.ALL_PLATFORMS</code>来获取所有平台的私聊流。</li></ul><p><strong>Returns</strong>:</p><ul><li><code>Optional[ChatStream]</code>：聊天流对象，如果未找到返回None</li></ul><h3 id="_6-获取聊天流类型" tabindex="-1">6. 获取聊天流类型 <a class="header-anchor" href="#_6-获取聊天流类型" aria-label="Permalink to “6. 获取聊天流类型”">​</a></h3><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> get_stream_type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(chat_stream: ChatStream) -&gt; </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span></code></pre></div><p><strong>Args</strong>:</p><ul><li><code>chat_stream</code>：聊天流对象</li></ul><p><strong>Returns</strong>:</p><ul><li><code>str</code>：聊天流类型，可能的值包括<code>private</code>（私聊流），<code>group</code>（群聊流）以及<code>unknown</code>（未知类型）。</li></ul><h3 id="_7-获取聊天流信息" tabindex="-1">7. 获取聊天流信息 <a class="header-anchor" href="#_7-获取聊天流信息" aria-label="Permalink to “7. 获取聊天流信息”">​</a></h3><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> get_stream_info</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(chat_stream: ChatStream) -&gt; Dict[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, Any]:</span></span></code></pre></div><p><strong>Args</strong>:</p><ul><li><code>chat_stream</code>：聊天流对象</li></ul><p><strong>Returns</strong>:</p><ul><li><code>Dict[str, Any]</code>：聊天流的详细信息，包括但不限于： <ul><li><code>stream_id</code>：聊天流ID</li><li><code>platform</code>：平台名称</li><li><code>type</code>：聊天流类型</li><li><code>group_id</code>：群聊ID</li><li><code>group_name</code>：群聊名称</li><li><code>user_id</code>：用户ID</li><li><code>user_name</code>：用户名称</li></ul></li></ul><h3 id="_8-获取聊天流统计摘要" tabindex="-1">8. 获取聊天流统计摘要 <a class="header-anchor" href="#_8-获取聊天流统计摘要" aria-label="Permalink to “8. 获取聊天流统计摘要”">​</a></h3><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> get_streams_summary</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() -&gt; Dict[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]:</span></span></code></pre></div><p><strong>Returns</strong>:</p><ul><li><code>Dict[str, int]</code>：聊天流统计信息摘要，包含以下键： <ul><li><code>total_streams</code>：总聊天流数量</li><li><code>group_streams</code>：群聊流数量</li><li><code>private_streams</code>：私聊流数量</li><li><code>qq_streams</code>：QQ平台流数量</li></ul></li></ul><h2 id="注意事项" tabindex="-1">注意事项 <a class="header-anchor" href="#注意事项" aria-label="Permalink to “注意事项”">​</a></h2><ol><li>大部分函数在参数不合法时候会抛出异常，请确保你的程序进行了捕获。</li><li><code>ChatStream</code>对象包含了聊天的完整信息，包括用户信息、群信息等。</li></ol>`,55)),a(t),a(e)])}const b=l(r,[["render",k]]);export{u as __pageData,b as default};
